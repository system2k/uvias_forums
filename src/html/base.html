<!DOCTYPE html>
<html lang="en" style="height: 100%">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<title>Forum</title>
		<style>
			* {
				margin: 0;
				padding: 0;
			}
			table {
				border-collapse: collapse;
			}
			#sidebar {
				min-width: 180px;
				max-width: 180px;
				width: 180px;
				height: 100%;
				background-color: #DDEEFF;
				overflow: hidden;
				padding: 13px;
				background-image: url("/images/sidebar.png");
			}
			#content {
				padding: 7px;
			}
			.sidebarContentTitlebar, .sfhead {
				color: #FFFFFF;
				font-family: 'Verdana';
				font-size: 12px;
				background-image: url("/images/bar.gif");
				height: 19px;
				background-color: #4455AA;
			}
			.sidebarTable {
				background-color: #FFFFFF;
				width: 100%;
				border-width: 1px;
				border-spacing: 1px;
				border-collapse: separate;
				border-style: solid;
				border-color: #013DA4;
			}
			.sidebarTablePanelHolder {
				background-color: #FFFFFF;
			}
			.sidebarSeparator {
				height: 13px;
			}
			.sidebarTablePanel {
				 margin: 4px;
			}
			tr {
				margin: 4px;
			}
			.rowText {
				margin-left: 3px;
			}
			.loginLabel {
				font-family: 'Verdana';
				font-size: 10px;
			}
			.thread_bar {
				background-image: url("/images/bottom_bar.png");
				height: 19px;
			}
			a.rowText:hover, a.control:hover {
				color: #DD6900
			}
			.sblink:link, .sblink:visited, .control:link, .control:visited {
				color: blue
			}
			.sblink:active, a.control:active {
				color: initial
			}
			input {
				box-sizing: border-box;
				-webkit-box-sizing: border-box;
				-moz-box-sizing: border-box;
			}
			
			.defaultTable {
				width: 100%;
				table-layout: auto;
				font-family: Verdana;
				border-spacing: 1px;
				border-collapse: separate;
				border-width: 1px;
				border-style: solid;
				border-color: #013DA4;
			}
			.defaultTable th {
				background-image: url('/images/bar.gif');
				color: white;
				height: 25px;
				font-family: 'Verdana';
				font-size: 12px;
				padding-left: 4px;
				padding-right: 4px;
			}
			.location {
				word-break: break-all;
				display: block;
				min-height: 30px;
				font-family: Arial;
				font-weight: bold;
			}
		</style>
		
		{% block scriptcontent %}{% endblock %}
		
		<script>
			function loginForm() {
				document.FORM.action="/login"
				document.FORM.submit()
			}
			window.onload = function(){
				var user = document.getElementById("loginUser")
				var pass = document.getElementById("loginPass")
				if(user && pass) {
					user.onkeydown = loginEnter
					pass.onkeydown = loginEnter
				}
			}
			function loginEnter(e) {
				var code = e.keyCode || e.which
				if(code == 13 || code == 3) {
					loginForm()
				}
			}
			function FormSubmit(command, arguments_, location) {
				if(document.getElementById("loginUser")) {
					document.getElementById("loginUser").disabled = true
				}
				if(document.getElementById("loginPass")) {
					document.getElementById("loginPass").disabled = true
				}
			
				var str = ""
				var len = Object.keys(arguments_).length
				var index = 0;
				for(i in arguments_){
					str += encodeURIComponent(i) + "=" + encodeURIComponent(arguments_[i])
					if(index < len - 1) str += "&"
					index++
				}
				var argumentString = encodeURIComponent(str)
			
				if(location !== undefined) document.FORM.action = location;
				document.getElementById("cmd").value = command;
				document.getElementById("arg").value = argumentString;
				document.FORM.submit();
			}
		</script>
	</head>
	<body style="height: 100%">
		<form name="FORM" method="post" action="{{page_path}}" style="height: 100%">
			<input type="hidden" name="command" id="cmd">
			<input type="hidden" name="arguments" id="arg">
			<table style="width: 100%; height: 100%;">
				<tbody style="height: 100%">
					<tr style="height: 100%">
						<td style="width: 180px; height: 100%;">
							<div id="sidebar">
								{% if logged_in %}
								<table class='sidebarTable'>
									<tbody>
										<tr>
											<th class='sidebarContentTitlebar'>Account</th>
										</tr>
										<tr>
											<th class='sidebarTablePanelHolder'>
												<div class='sidebarTablePanel' style="text-align: center; font-family: Arial;">
													<span style="float:left; font-size: 0.8em; word-break: break-all;">Logged in as: {{username}}</span>
													<br>
													<a href="/logout" class="sblink">Log out</a>
													<br>
													<a href="/myforums" class="sblink">My forums</a>
													<br>
													<a href="/members" class="sblink">Members</a>
													<br>
													<a href="/search" class="sblink">Search</a>
													<br>
													<a href="/inbox" class="sblink">Inbox</a>
													{% if top_rank %}
													<br>
													<a href="/admin" class="sblink">Admin panel</a>
													{% endif %}
												</div>
											</th>
										</tr>
									</tbody>
								</table>
								<div class='sidebarSeparator'></div>
								{% elseif !login_page %}
								<table class='sidebarTable'>
									<tbody>
										<tr>
											<th class='sidebarContentTitlebar'>Login</th>
										</tr>
										<tr>
											<th class='sidebarTablePanelHolder'>
												<div class='sidebarTablePanel' style="text-align: left;">
													<table style="width: 100%">
														<tbody>
															<tr>
																<td style="width: 1px">
																	<span class="loginLabel">Username:&nbsp;</span>
																</td>
																<td>
																	<input type="text" name="user" style="width: 96%" id="loginUser">
																</td>
															</tr>
															<tr>
																<td style="width: 1px">
																	<span class="loginLabel">Password:&nbsp;</span>
																</td>
																<td>
																	<input type="password" name="pass" style="width: 96%" id="loginPass">
																</td>
															</tr>
														</tbody>
													</table>
													
													<input type="submit" value="Login" style="float:right;" form="login" onclick="loginForm()">
													<a href="/register" class="sblink">Create an account</a>
												</div>
											</th>
										</tr>
									</tbody>
								</table>
								<div class='sidebarSeparator'></div>
								{% endif %}
								
								{% if announcement != "No announcement" %}
								
								<table class='sidebarTable'>
									<tbody>
										<tr>
											<th class='sidebarContentTitlebar'>Announcement</th>
										</tr>
										<tr>
											<th class='sidebarTablePanelHolder'>
												<div class='sidebarTablePanel'>
													{{announcement | safe}}
												</div>
											</th>
										</tr>
									</tbody>
								</table>
								<div class='sidebarSeparator'></div>
								{% endif %}
								
								<table class='sidebarTable'>
									<tbody>
										<tr>
											<th class='sidebarContentTitlebar'>Quick links</th>
										</tr>
										<tr>
											<th class='sidebarTablePanelHolder'>
												<div class='sidebarTablePanel'>
													<a href="/" class="sblink">Home - Forums</a>
													{% if !logged_in %}
													<br>
													<a href="/login" class="sblink">Login</a>
													{% endif %}
												</div>
											</th>
										</tr>
									</tbody>
								</table>
							</div>
						</td>
						<td style="height: 100%">
							<div style="height: 100%" id="content">
								{% block content %}{% endblock %}
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</form>
	</body>
</html>